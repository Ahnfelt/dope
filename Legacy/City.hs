module Citywhere

-- | Geographic coordinate express in radians
type GeographicCoordinate = (Double, Double)

data City= City{
    cityName :: String,
    cityCountry :: String,
    cityCoordinate :: GeographicCoordinate
    } deriving (Show)

-- | The great-circle distance using the Vincenty formula
-- | from http://en.wikipedia.org/wiki/Great-circle_distance
geographicDistance :: GeographicCoordinate -> GeographicCoordinate -> Double
geographicDistance (phi1, lambda1) (phi2, lambda2) = 
    let earthRadius = 6372800 in
    let lambdaDelta = lambda2 - lambda1 in
    let top = (cos phi2 * sin lambdaDelta)^2 +
            (cos phi1 * sin phi2 - sin phi1 * cos phi2 * cos lambdaDelta)^2 in
    let buttom = sin phi1 * sin phi2 + cos phi1 * cos phi2 * cos lambdaDelta in
    let centralAngle = atan2 (sqrt top) buttom in
    earthRadius * centralAngle

cityDistance city1 city2 = geographicDistance (cityCoordinate city1) (cityCoordinate city2)

-- | from http://www.infoplease.com/ipa/A0001769.html
majorCities = [
    City "Algiers" "Algeria" (0.6429, 0.0524),
    City "Buenos Aires" "Argentina" (-0.6036, -1.0187),
    City "Córdoba" "Argentina" (-0.5492, -1.1199),
    City "Adelaide" "Australia" (-0.6094, 2.4190),
    City "Brisbane" "Australia" (-0.4797, 2.6727),
    City "Darwin" "Australia" (-0.2176, 2.2838),
    City "Melbourne" "Australia" (-0.6594, 2.5301),
    City "Perth" "Australia" (-0.5576, 2.0223),
    City "Sydney" "Australia" (-0.5934, 2.6354),
    City "Vienna" "Austria" (0.8418, 0.2851),
    City "Brussels" "Belgium" (0.8878, 0.0762),
    City "La Paz" "Bolivia" (-0.2871, -1.1932),
    City "Belém" "Brazil" (-0.0256, -0.8462),
    City "Rio de Janeiro" "Brazil" (-0.4006, -0.7540),
    City "Salvador" "Brazil" (-0.2257, -0.6711),
    City "São Paulo" "Brazil" (-0.4104, -0.8119),
    City "Sofia" "Bulgaria" (0.7447, 0.4072),
    City "Iquique" "Chile" (-0.3520, -1.2238),
    City "Santiago" "Chile" (-0.5841, -1.2348),
    City "Beijing" "China" (0.6967, 2.0319),
    City "Canton" "China" (0.4035, 1.9766),
    City "Chongqing" "China" (0.5195, 1.8599),
    City "Hong Kong" "China" (0.3898, 1.9929),
    City "Nanjing (Nanking)" "China" (0.5594, 2.0749),
    City "Shanghai" "China" (0.5440, 2.1200),
    City "Bogotá" "Colombia" (0.0791, -1.2959),
    City "Kinshasa" "Congo" (-0.0750, 0.2667),
    City "Havana" "Cuba" (0.4038, -1.4379),
    City "Prague" "Czech Republic" (0.8741, 0.2519),
    City "Copenhagen" "Denmark" (0.9716, 0.2193),
    City "Djibouti" "Djibouti" (0.2007, 0.7514),
    City "Guayaquil" "Ecuador" (-0.0378, -1.3951),
    City "Cairo" "Egypt" (0.5242, 0.5472),
    City "Birmingham" "England" (0.9148, -0.0335),
    City "Bristol" "England" (0.8983, -0.0451),
    City "Leeds" "England" (0.9381, -0.0262),
    City "Liverpool" "England" (0.9323, -0.0524),
    City "London" "England" (0.8994, -0.0015),
    City "Manchester" "England" (0.9338, -0.0393),
    City "Newcastle-on-Tyne" "England" (0.9593, -0.0282),
    City "Plymouth" "England" (0.8799, -0.0713),
    City "Helsinki" "Finland" (1.0501, 0.4363),
    City "Bordeaux" "France" (0.7825, -0.0090),
    City "Lyons" "France" (0.7985, 0.0844),
    City "Marseilles" "France" (0.7563, 0.0931),
    City "Paris" "France" (0.8517, 0.0407),
    City "Cayenne" "French Guiana" (0.0841, -0.9128),
    City "Berlin" "Germany" (0.9163, 0.2342),
    City "Bremen" "Germany" (0.9265, 0.1539),
    City "Frankfurt" "Germany" (0.8747, 0.1516),
    City "Hamburg" "Germany" (0.9346, 0.1751),
    City "Munich" "Germany" (0.8401, 0.2022),
    City "Athens" "Greece" (0.6626, 0.4139),
    City "Guatemala City" "Guatemala" (0.2551, -1.5798),
    City "Georgetown" "Guyana" (0.1178, -1.0167),
    City "Budapest" "Hungary" (0.8290, 0.3331),
    City "Reykjavík" "Iceland" (1.1182, -0.3834),
    City "Bombay" "India" (0.3316, 1.2706),
    City "Calcutta" "India" (0.3939, 1.5429),
    City "New Delhi" "India" (0.4989, 1.3474),
    City "Jakarta" "Indonesia" (-0.1094, 1.8640),
    City "Teheran" "Iran" (0.6240, 0.9032),
    City "Dublin" "Ireland" (0.9308, -0.1091),
    City "Milan" "Italy" (0.7933, 0.1600),
    City "Naples" "Italy" (0.7127, 0.2487),
    City "Rome" "Italy" (0.7313, 0.2173),
    City "Venice" "Italy" (0.7930, 0.2153),
    City "Kingston" "Jamaica" (0.3139, -1.3407),
    City "Nagasaki" "Japan" (0.5725, 2.2681),
    City "Nagoya" "Japan" (0.6129, 2.3899),
    City "Osaka" "Japan" (0.6027, 2.3649),
    City "Tokyo" "Japan" (0.6225, 2.4391),
    City "Nairobi" "Kenya" (-0.0247, 0.6443),
    City "Tripoli" "Libya" (0.5751, 0.2304),
    City "Tananarive" "Madagascar" (-0.3287, 0.8299),
    City "Kuala Lumpur" "Malaysia" (0.0547, 1.7750),
    City "Chihuahua" "Mexico" (0.4995, -1.8515),
    City "Mazatlán" "Mexico" (0.4049, -1.8573),
    City "Mexico City" "Mexico" (0.3392, -1.7299),
    City "Veracruz" "Mexico" (0.3345, -1.6784),
    City "Rangoon" "Myanmar" (0.2938, 1.6755),
    City "Amsterdam" "Netherlands" (0.9140, 0.0852),
    City "Auckland" "New Zealand" (-0.6434, 3.0500),
    City "Wellington" "New Zealand" (-0.7205, 3.0505),
    City "Belfast" "Northern Ireland" (0.9532, -0.1036),
    City "Hammerfest" "Norway" (1.2328, 0.4125),
    City "Oslo" "Norway" (1.0463, 0.1868),
    City "Panama City" "Panama" (0.1565, -1.3881),
    City "Port Moresby" "Papua New Guinea" (-0.1644, 2.5680),
    City "Asunción" "Paraguay" (-0.4407, -1.0065),
    City "Lima" "Peru" (-0.2094, -1.3445),
    City "Manila" "Philippines" (0.2545, 2.1110),
    City "Warsaw" "Poland" (0.9116, 0.3665),
    City "Lisbon" "Portugal" (0.6760, -0.1597),
    City "Bucharest" "Romania" (0.7752, 0.4558),
    City "Irkutsk" "Russia" (0.9163, 1.8210),
    City "Moscow" "Russia" (0.9730, 0.6562),
    City "St. Petersburg" "Russia" (1.0460, 0.5288),
    City "Vladivostok" "Russia" (0.7534, 2.3038),
    City "Mecca" "Saudi Arabia" (0.3750, 0.6938),
    City "Aberdeen" "Scotland" (0.9975, -0.0375),
    City "Edinburgh" "Scotland" (0.9759, -0.0553),
    City "Glasgow" "Scotland" (0.9745, -0.0742),
    City "Dakar" "Senegal" (0.2560, -0.3049),
    City "Belgrade" "Serbia" (0.7831, 0.3584),
    City "Singapore" "Singapore" (0.0215, 1.8137),
    City "Cape Town" "South Africa" (-0.5920, 0.3206),
    City "Durban" "South Africa" (-0.5216, 0.5390),
    City "Johannesburg" "South Africa" (-0.4573, 0.4899),
    City "Barcelona" "Spain" (0.7223, 0.0375),
    City "Madrid" "Spain" (0.7057, -0.0646),
    City "Paramaribo" "Suriname" (0.1004, -0.9643),
    City "Stockholm" "Sweden" (1.0347, 0.3150),
    City "Zürich" "Switzerland" (0.8264, 0.1486),
    City "Hobart" "Tasmania" (-0.7482, 2.5712),
    City "Bangkok" "Thailand" (0.2400, 1.7541),
    City "Ankara" "Turkey" (0.6967, 0.5745),
    City "Odessa" "Ukraine" (0.8107, 0.5376),
    City "Montevideo" "Uruguay" (-0.6088, -0.9803),
    City "Caracas" "Venezuela" (0.1827, -1.1700)]
    
